<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
  <link rel="icon" href="shark.gif?v=2" type="image/gif">
  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="shortcut icon" href="favicon.png" type="image/png">
  <link rel="apple-touch-icon" href="favicon.png">
  <title>Yi</title>
  <link rel="stylesheet" href="style.css" />
</head>

<!-- 海洋主题 -->
<!-- <body class="theme-ocean"> -->
<!-- <canvas id="caustics"></canvas> -->

<!-- 赛博朋克主题 -->
<body class="theme-cyberpixel">
<header class="site-header">
  <h1>Yi</h1>
  <p class="tagline">Web · Creative Coding</p>
  <nav>
    <a href="#projects">Projects</a>
    <a href="#about">About</a>
  </nav>
</header>

<main>
  <section id="projects">
    <h2>Projects</h2>
    <div id="grid" class="grid"></div>
  </section>

  <section id="about">
    <h2>About</h2>
    <img id="avatar" alt="avatar" style="width:72px;height:72px;border-radius:50%;object-fit:cover;margin:8px 0;">
    <p id="desc"></p>
    <p id="about-text"></p>
    <p id="contact"></p>
    <ul id="about-links"></ul>
  </section>
</main>

<footer>
  <p>© <span id="year"></span> Yi — <a href="https://github.com/yoooyii">GitHub</a></p>
</footer>

<!-- 年份 + 渲染项目 -->
<script>
  document.getElementById('year').textContent = new Date().getFullYear();
  fetch('projects.json?ts=' + Date.now())
    .then(r => r.json())
    .then(list => {
      const grid = document.getElementById('grid');
      grid.innerHTML = list.map(p => `
        <a class="card" href="${p.demo || p.repo}" target="_blank" rel="noopener">
          <img src="${p.thumb || 'thumb-placeholder.webp'}" alt="${p.title}" />
          <div class="card-body">
            <h3>${p.title}</h3>
            <p>${p.desc}</p>
            <div class="tags">${(p.tags||[]).map(t=>`<span>${t}</span>`).join('')}</div>
          </div>
        </a>
      `).join('');
    });
  (function(){
    const c=document.getElementById('caustics'); if(!c) return; const ctx=c.getContext('2d'); // ← 没有 canvas 就直接跳过整个特效
    function resize(){ c.width=innerWidth; c.height=innerHeight; } resize();
    addEventListener('resize', resize);
    let t=0;
    function draw(){
      t+=0.004; const w=c.width, h=c.height;
      const g=ctx.createLinearGradient(0,0,0,h); g.addColorStop(0,'rgba(255,255,255,.18)'); g.addColorStop(.3,'rgba(255,255,255,.06)'); g.addColorStop(1,'rgba(255,255,255,0)');
      ctx.clearRect(0,0,w,h);
      ctx.globalCompositeOperation='lighter'; ctx.fillStyle=g;
      const rows=14, cols=22;
      for(let y=0;y<rows;y++){
        for(let x=0;x<cols;x++){
          const u=x/cols, v=y/rows;
          const amp=1.5+Math.sin((u*10+v*8)+t*6)*0.9;
          const X = u*w + Math.sin((v*3+t*2))*20;
          const Y = v*h*0.5 + Math.sin((u*2+t))*10;
          ctx.beginPath(); ctx.ellipse(X, Y, 80*amp, 12*amp, Math.PI/6, 0, Math.PI*2); ctx.fill();
        }
      }
      ctx.globalCompositeOperation='destination-in';
      const mask=ctx.createLinearGradient(0,0,0,h);
      mask.addColorStop(0,'rgba(0,0,0,1)');
      mask.addColorStop(.4,'rgba(0,0,0,.25)');
      mask.addColorStop(.7,'rgba(0,0,0,0)');
      ctx.fillStyle=mask; ctx.fillRect(0,0,w,h);
      requestAnimationFrame(draw);
    }
    draw();
  })();

  async function loadAbout(){
    const res = await fetch('about.json');
    const data = await res.json();
    document.getElementById('avatar').src = data.avatar;
    document.getElementById('desc').textContent = data.description;
    document.getElementById('about-text').textContent = data.about_text;
    document.getElementById('contact').innerHTML = `<strong>Email:</strong> <a href="mailto:${data.email}">${data.email}</a>`;

    const links = document.getElementById('about-links');
    if(data.email){
      const li = document.createElement('li');
      li.innerHTML = `<strong>Email:</strong> <a href="mailto:${data.email}">${data.email}</a>`;
      links.appendChild(li);
    }
    if(data.links){
      for(const [name,url] of Object.entries(data.links)){
        const li = document.createElement('li');
        li.innerHTML = `<strong>${name}:</strong> <a href="${url}" target="_blank">${url}</a>`;
        links.appendChild(li);
      }
    }
  }
  loadAbout();
</script>

<!-- 海洋微粒层 -->
<!-- <div class="ocean-particles"></div> -->
</body>
</html>
